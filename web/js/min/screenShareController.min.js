(e=>{let r,n,t,s=!1;let o,a=!1;const l={insertMode:"append",width:"100%",height:"100%",name:"screen",showControls:!1,style:{nameDisplayMode:"off"},publishAudio:!1,videoSource:"screen"},i={destroyed(){t=!1,Utils.sendEvent("screenShareController:destroyed"),a&&Utils.sendEvent("screenShareController:annotationEnded")}},d={shareScreen(){if(!s)if(t)o.stopShareScreen(),t=!1;else{const e=RoomView.createStreamView("desktop",{name:l.name,type:"desktop",controlElems:{}});s=!0,o.shareScreen(e,l,i,a).then(()=>{t=!0,s=!1,Utils.sendEvent("screenShareController:changeScreenShareStatus",{isSharing:t}),a&&Utils.sendEvent("screenShareController:annotationStarted")}).catch(e=>{s=!1,e.code===OTHelper.screenShareErrorCodes.accessDenied?RoomView.deleteStreamView("desktop"):Utils.sendEvent("screenShareController:shareScreenError",{code:e.code,message:e.message})})}}},c={installExtension(){const e=window.open("https://chrome.google.com/webstore/detail/"+n,"_blank"),t=!e||"object"!=typeof e;Utils.sendEvent("screenShareController:extInstallationResult",{error:t,message:t?"It seems you have a Pop-Up blocker enabled. Please disabled it and try again.":null}),t&&r.error("Error opening Chrome Webstore")}};const h={init:function(s,i,h,S){return LazyLoader.dependencyLoad(["/js/min/screenShareView.min.js"]).then(()=>{a=S,o=h,r=new Utils.MultiLevelLogger("screenShareController.js",Utils.MultiLevelLogger.DEFAULT_LEVELS.all),Utils.addEventsHandlers("roomView:",d,e),Utils.addEventsHandlers("screenShareView:",c,e),t=!1,l.name=(s||"Unknown")+"'s screen",n=i,i&&"undefined"!==i&&OTHelper.registerScreenShareExtension({chrome:i},1),ScreenShareView.init(s)})},get chromeExtId(){return n}};e.ScreenShareController=h})(this);